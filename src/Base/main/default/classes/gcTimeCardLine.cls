public without sharing class gcTimeCardLine {
  public static Boolean disableTrigger {
    get {
      if (disableTrigger == null)
        return false;
      else
        return disableTrigger;
    }
    set {
      if (value == null)
        disableTrigger = false;
      else
        disableTrigger = value;
    }
  }

  public static void triggerHandler(
    map<Id, AcctSeed__Time_Card_Line__c> oldMap,
    map<Id, AcctSeed__Time_Card_Line__c> newMap,
    list<AcctSeed__Time_Card_Line__c> listNew,
    Boolean boolIsBefore,
    Boolean boolIsInsert,
    Boolean boolIsUpdate,
    Boolean boolIsDelete
  ) {
    if (oldMap == null)
      oldMap = new Map<Id, AcctSeed__Time_Card_Line__c>();
    if (newMap == null)
      newMap = new Map<Id, AcctSeed__Time_Card_Line__c>();
    if (listNew == null)
      listNew = new List<AcctSeed__Time_Card_Line__c>();

    updateAndValidate(oldMap, newMap, listNew, boolIsBefore, boolIsInsert, boolIsUpdate, boolIsDelete);

    if (boolIsBefore) {
      if (boolIsInsert) {
      }
      if (boolIsUpdate) {
      }
      if (boolIsDelete) {
      }
    } else //i.e. trigger.isAfter
    {
      if (boolIsInsert) {
      }
      if (boolIsUpdate) {
      }
      if (boolIsDelete) {
      }
    }
  }

  private static Id idTcv1Work { get; set; }
  private static Id idTcv2Direct { get; set; }
  private static map<Id, AcctSeed__Time_Card__c> mapTimeCard { get; set; }
  private static map<Id, AcctSeed__Project__c> mapProject { get; set; }
  private static map<Id, AcctSeed__Project__c> mapProjectUpdate { get; set; }
  private static map<Id, AcctSeed__Accounting_Variable__c> mapTCV2 { get; set; }
  private static map<Id, list<Employee_Wage_Rate__c>> mapDirectWage { get; set; } //map of user.Id to a list of wage rates for the underlying employee

  private static void retrieveStatics(list<AcctSeed__Time_Card_Line__c> listTCL) {
    set<Id> setIdTimeCard = new Set<Id>();
    set<Id> setIdProject = new Set<Id>();
    set<Id> setIdUser = new Set<Id>();
    set<Id> setTCV2 = new Set<Id>();

    if (mapTimeCard == null)
      mapTimeCard = new Map<Id, AcctSeed__Time_Card__c>();
    if (mapProject == null)
      mapProject = new Map<Id, AcctSeed__Project__c>();
    if (mapProjectUpdate == null)
      mapProjectUpdate = new Map<Id, AcctSeed__Project__c>();
    if (mapTCV2 == null)
      mapTCV2 = new Map<Id, AcctSeed__Accounting_Variable__c>();
    if (mapDirectWage == null)
      mapDirectWage = new Map<Id, list<Employee_Wage_Rate__c>>();

    for (AcctSeed__Time_Card_Line__c tcl : listTCL) {
      if (!mapTimeCard.containsKey(tcl.AcctSeed__Time_Card__c))
        setIdTimeCard.add(tcl.AcctSeed__Time_Card__c);

      if (!mapProject.containsKey(tcl.AcctSeed__Project__c))
        setIdProject.add(tcl.AcctSeed__Project__c);

      if (!mapTCV2.containsKey(tcl.AcctSeed__Time_Card_Variable_2__c))
        setTCV2.add(tcl.AcctSeed__Time_Card_Variable_2__c);
    }

    if (setIdTimeCard.size() > 0)
      for (AcctSeed__Time_Card__c tc : [
        SELECT
          Id,
          AcctSeed__Employee__c,
          AcctSeed__Time_Card_Period__c,
          AcctSeed__Time_Card_Period__r.AcctSeed__Start_Date__c,
          AcctSeed__Time_Card_Period__r.AcctSeed__Status__c
        FROM AcctSeed__Time_Card__c
        WHERE Id IN :setIdTimeCard
      ]) {
        mapTimeCard.put(tc.Id, tc);
        if (!mapDirectWage.containsKey(tc.AcctSeed__Employee__c))
          setIdUser.add(tc.AcctSeed__Employee__c);
      }

    if (setIdUser.size() > 0)
      for (Employee__c e : [
        SELECT
          Id,
          User__c,
          (
            SELECT Id, Apprentice_Rate__c, Effective_Date__c, Base__c, Benefits__c
            FROM Employee_Wage_Rates__r
            ORDER BY Effective_Date__c DESC
          )
        FROM Employee__c
        WHERE User__c IN :setIdUser
      ]) {
        mapDirectWage.put(e.User__c, e.Employee_Wage_Rates__r);
      }

    if (idTcv1Work == null) {
      for (AcctSeed__Accounting_Variable__c glvx : [
        SELECT Id, Uniquefier__c
        FROM AcctSeed__Accounting_Variable__c
        WHERE Uniquefier__c IN ('DIRECT', 'WORK')
      ]) {
        if (glvx.Uniquefier__c == 'DIRECT')
          idTcv2Direct = glvx.Id;
        else
          idTcv1Work = glvx.Id;
      }
    }

    if (setIdProject.size() > 0)
      for (AcctSeed__Project__c p : [
        SELECT
          Id,
          First_Certified_Period__c,
          (
            SELECT Id, Time_Card_Variable_2__c, Time_Card_Variable_2__r.Name, Base__c, Benefits__c
            FROM Project_Labor_Rates__r
            WHERE Time_Card_Variable_2__c != NULL AND Time_Card_Variable_2__c != :idTcv2Direct
          ),
          (SELECT Id FROM AcctSeed__Project_Tasks__r)
        FROM AcctSeed__Project__c
        WHERE Id IN :setIdProject
      ]) {
        mapProject.put(p.Id, p);
      }

    if (setTCV2.size() > 0)
      for (AcctSeed__Accounting_Variable__c tcv2 : [
        SELECT Id, Name
        FROM AcctSeed__Accounting_Variable__c
        WHERE Id IN :setTCV2
      ]) {
        mapTCV2.put(tcv2.Id, tcv2);
      }
  }

  private static void updateAndValidate(
    map<Id, AcctSeed__Time_Card_Line__c> oldMap,
    map<Id, AcctSeed__Time_Card_Line__c> newMap,
    list<AcctSeed__Time_Card_Line__c> listNew,
    Boolean boolIsBefore,
    Boolean boolIsInsert,
    Boolean boolIsUpdate,
    Boolean boolIsDelete
  ) {
    if (boolIsBefore) {
      /*
            map<Id,AcctSeed__Time_Card__c> mapTimeCard = new map<Id,AcctSeed__Time_Card__c>();
            map<Id,AcctSeed__Project__c> mapProject = new map<Id,AcctSeed__Project__c>();
            map<Id,list<Employee_Wage_Rate__c>> mapDirectWage = new map<Id,list<Employee_Wage_Rate__c>>();
            */

      list<AcctSeed__Time_Card_Line__c> listTCL = new List<AcctSeed__Time_Card_Line__c>();
      listTCL.addAll(listNew);
      listTCL.addAll(oldMap.values());

      retrieveStatics(listTCL);

      if (boolIsInsert || boolIsUpdate) {
        updateWage(listNew);
        updateFirstCertifiedPeriod(listNew);

        for (AcctSeed__Time_Card_Line__c tcl : listNew) {
          if (tcl.AcctSeed__Time_Card_Variable_1__c == null)
            tcl.AcctSeed__Time_Card_Variable_1__c = idTcv1Work;

          if (tcl.AcctSeed__Time_Card_Variable_2__c == null)
            tcl.AcctSeed__Time_Card_Variable_2__c = idTcv2Direct;

          AcctSeed__Time_Card__c tc = mapTimeCard.get(tcl.AcctSeed__Time_Card__c);

          if (tc.AcctSeed__Time_Card_Period__r.AcctSeed__Status__c != 'Open')
            tcl.addError('The Time Card Line cannot be inserted or updated, because the Time Card Period is not open.');
          if (
            boolIsUpdate &&
            mapTimeCard.get(oldMap.get(tcl.Id).AcctSeed__Time_Card__c)
              .AcctSeed__Time_Card_Period__r.AcctSeed__Status__c != 'Open'
          )
            tcl.addError('The Time Card Line cannot be updated, because the Time Card Period is not open.');
          else if (boolIsUpdate && tcl.AcctSeed__Time_Card__c != oldMap.get(tcl.Id).AcctSeed__Time_Card__c)
            tcl.addError('A Time Card Line cannot be moved to a different Time Card.');
          else if (tcl.AcctSeed__Project__c == null && tcl.AcctSeed__Project_Task__c != null)
            tcl.addError('A Project is required, if a Project Task has been specified.');
          else if (tcl.AcctSeed__Project__c != null && tcl.AcctSeed__Project_Task__c == null)
            tcl.addError('A Project Task is required, if a Project has been specified.');
          else if (tcl.AcctSeed__Project__c != null) {
            AcctSeed__Project__c p = mapProject.get(tcl.AcctSeed__Project__c);
            Boolean boolProjectTaskFound = false;
            for (AcctSeed__Project_Task__c pt : p.AcctSeed__Project_Tasks__r) {
              if (pt.Id == tcl.AcctSeed__Project_Task__c)
                boolProjectTaskFound = true;
            }
            if (!boolProjectTaskFound)
              tcl.addError('The Project Task does not match the Project.');

            Boolean boolTCV2found = false;
            if (tcl.AcctSeed__Time_Card_Variable_2__c == idTcv2Direct)
              boolTCV2found = true;
            else
              for (Project_Labor_Rate__c plr : p.Project_Labor_Rates__r) {
                if (plr.Time_Card_Variable_2__c == tcl.AcctSeed__Time_Card_Variable_2__c) {
                  boolTCV2found = true;
                  break;
                }
              }
            if (!boolTCV2found)
              tcl.addError(
                'The value for Time Card Variable 2 must be among the Project Labor Rates for the specified Project.'
              );
          }

          String uniqueKey = tcl.AcctSeed__Time_Card__c;

          if (tcl.AcctSeed__Project__c != null)
            uniqueKey += tcl.AcctSeed__Project__c;
          if (tcl.AcctSeed__Project_Task__c != null)
            uniqueKey += tcl.AcctSeed__Project_Task__c;
          if (tcl.AcctSeed__Time_Card_Variable_1__c != null)
            uniqueKey += tcl.AcctSeed__Time_Card_Variable_1__c;
          if (tcl.AcctSeed__Time_Card_Variable_2__c != null)
            uniqueKey += tcl.AcctSeed__Time_Card_Variable_2__c;

          tcl.Uniquefier__c = uniqueKey;
        }
      } else if (boolIsDelete)
        for (AcctSeed__Time_Card_Line__c tcl : oldMap.values()) {
          if (mapTimeCard.get(tcl.AcctSeed__Time_Card__c).AcctSeed__Time_Card_Period__r.AcctSeed__Status__c != 'Open')
            tcl.addError('The Time Card Line cannot be deleted, because the Time Card Period is not open.');
        }
    } else {
      if (
        boolIsDelete //what about when a TCL is updated such that the TCV1 or TCV2 is changed?  shouldn't the wages be recalculated?
      ) {
        set<Id> setIdTimeCard = new Set<Id>();
        for (AcctSeed__Time_Card_Line__c tcl : oldMap.values()) {
          setIdTimeCard.add(tcl.AcctSeed__Time_Card__c);
        }
        if (setIdTimeCard.size() > 0)
          gcTimeCardDay.recalcOvertime(setIdTimeCard);
      }
    }
  }

  //wage rates are stored on Time Card Lines, and are determined by a combination of Employee Wage Rates and Project Labor Rates
  //when either type of record is updated or deleted, the wage rate on the time card line must be recalculated.
  public static void updateWage(list<AcctSeed__Time_Card_Line__c> listTCL) {
    if (idTcv2Direct == null)
      retrieveStatics(listTCL);

    for (AcctSeed__Time_Card_Line__c tcl : listTCL) {
      Decimal prevailingBase;
      Decimal prevailingBenefits;
      Decimal directBase;
      Decimal directBenefits;
      Decimal apprenticeRate;

      AcctSeed__Time_Card__c tc = mapTimeCard.get(tcl.AcctSeed__Time_Card__c);

      if (tc.AcctSeed__Time_Card_Period__r.AcctSeed__Status__c != 'Open')
        continue;

      if (
        mapDirectWage.get(tc.AcctSeed__Employee__c) != null && !mapDirectWage.get(tc.AcctSeed__Employee__c).isEmpty()
      ) {
        for (Employee_Wage_Rate__c ewr : mapDirectWage.get(tc.AcctSeed__Employee__c)) {
          if (ewr.Effective_Date__c <= tc.AcctSeed__Time_Card_Period__r.AcctSeed__Start_Date__c) {
            directBase = ewr.Base__c;
            directBenefits = ewr.Benefits__c;
            apprenticeRate = ewr.Apprentice_Rate__c;
            break;
          }
        }
      }

      AcctSeed__Project__c project = mapProject.get(tcl.AcctSeed__Project__c);

      if (project != null && !project.Project_Labor_Rates__r.isEmpty()) {
        for (Project_Labor_Rate__c plr : project.Project_Labor_Rates__r) {
          if (
            plr.Time_Card_Variable_2__c == tcl.AcctSeed__Time_Card_Variable_2__c &&
            plr.Time_Card_Variable_2__c != idTcv2Direct
          ) {
            prevailingBase = (plr.Base__c == null ? 0 : plr.Base__c);

            if (
              plr.Time_Card_Variable_2__r.Name != null &&
              plr.Time_Card_Variable_2__r.Name.startsWithIgnoreCase('DBA:') &&
              apprenticeRate != null &&
              apprenticeRate > 0 &&
              apprenticeRate <= 100
            ) {
              prevailingBase *= (apprenticeRate / 100);
            }

            prevailingBenefits = plr.Benefits__c;
            break;
          }
        }
      }

      tcl.Direct_Base__c = directBase;
      tcl.Direct_Benefits__c = directBenefits;
      tcl.Prevailing_Base__c = prevailingBase;
      tcl.Prevailing_Benefits__c = prevailingBenefits;

      if (directBase == null)
        directBase = 0;
      if (directBenefits == null)
        directBenefits = 0;
      if (prevailingBenefits == null)
        prevailingBenefits = 0;

      if (prevailingBase != null) {
        tcl.Wage_RT__c = prevailingBase + prevailingBenefits - directBenefits;
        tcl.Wage_OT__c = (prevailingBase * 1.5) + prevailingBenefits - directBenefits;
        tcl.Wage_DT__c = (prevailingBase * 2) + prevailingBenefits - directBenefits;

        if (directBase > tcl.Wage_RT__c) {
          tcl.Wage_RT__c = directBase;
          tcl.Wage_OT__c = directBase * 1.5;
          tcl.Wage_DT__c = directBase * 2;
        }
      } else {
        tcl.Wage_RT__c = directBase;
        tcl.Wage_OT__c = directBase * 1.5;
        tcl.Wage_DT__c = directBase * 2;
      }
    }
  }

  public static void updateFirstCertifiedPeriod(List<AcctSeed__Time_Card_Line__c> listTCL) {
    //Go through the items
    for (AcctSeed__Time_Card_Line__c tcl : listTCL) {
      //Get the TCV2
      AcctSeed__Accounting_Variable__c tcv2 = mapTCV2.get(tcl.AcctSeed__Time_Card_Variable_2__c);
      if (tcv2 == null)
        continue;

      //If TCV2 starts with 'DB: or DBA:'
      if (tcv2.Name.startsWithIgnoreCase('DB:') || tcv2.Name.startsWithIgnoreCase('DBA:')) {
        //If there are hours for the TCL
        if (tcl.Hours_RT__c > 0 || tcl.Hours_OT__c > 0 || tcl.Hours_DT__c > 0) {
          //Get the project
          AcctSeed__Project__c project = mapProject.get(tcl.AcctSeed__Project__c);

          //If the First Certified Period has not been set
          if (project.First_Certified_Period__c == null) {
            //Get the Time Card
            AcctSeed__Time_Card__c tc = mapTimeCard.get(tcl.AcctSeed__Time_Card__c);

            //Update the First Certified Period
            project.First_Certified_Period__c = tc.AcctSeed__Time_Card_Period__c;
            if (!mapProjectUpdate.containsKey(project.Id)) {
              mapProjectUpdate.put(project.Id, project);
            }
          }
        }
      }
    }

    //Update the projects for which we have set the First Certified Period
    List<AcctSeed__Project__c> listProjectUpdate = new List<AcctSeed__Project__c>();
    listProjectUpdate.addAll(mapProjectUpdate.values());

    update listProjectUpdate;
  }

  public static void coverage() {
    integer i;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
    i = 1;
  }
}

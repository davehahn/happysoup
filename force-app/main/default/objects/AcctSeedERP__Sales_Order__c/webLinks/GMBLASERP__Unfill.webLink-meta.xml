<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>GMBLASERP__Unfill</fullName>
    <availability>online</availability>
    <displayType>button</displayType>
    <linkType>javascript</linkType>
    <masterLabel>Un-fill</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <url>{!REQUIRESCRIPT(&quot;/soap/ajax/30.0/connection.js&quot;)}
{!REQUIRESCRIPT(&quot;/soap/ajax/30.0/apex.js&quot;)}

//launch a spinner
var spinDiv = document.createElement(&apos;div&apos;);
var spinCSS = &apos;&apos;;
spinCSS += &apos;background:rgba(0,0,0,.2);&apos;;
spinCSS += &apos;background-image:url(&quot;/img/loading32.gif&quot;);&apos;;
spinCSS += &apos;background-repeat:no-repeat;&apos;;
spinCSS += &apos;background-attachment:fixed;&apos;;
spinCSS += &apos;background-position:center;&apos;;
spinCSS += &apos;position:absolute;&apos;;
spinCSS += &apos;width:100%;&apos;;
spinCSS += &apos;height:100%;&apos;;
spinCSS += &apos;top:0;&apos;;
spinCSS += &apos;left:0;&apos;;
spinCSS += &apos;z-index:9998;&apos;;

spinDiv.id = &quot;spinDiv&quot;;
spinDiv.style.cssText = spinCSS;
document.body.appendChild(spinDiv);

var callbackSuccess = function(result) {
result = JSON.parse(result);
if(result.msg)
 alert(result.msg);
window.open(&apos;/{!AcctSeedERP__Sales_Order__c.Id}&apos;, &quot;_self&quot;);
};

var callbackFailure = function(error) {
alert(&apos;Process failure: &apos;+error);
window.open(&apos;/{!AcctSeedERP__Sales_Order__c.Id}&apos;, &quot;_self&quot;);
}; 

sforce.apex.execute(&quot;GMBLASERP.gcSalesOrder_Ext&quot;,&quot;unfillOrderWS&quot;,{idSalesOrder:&quot;{!AcctSeedERP__Sales_Order__c.Id}&quot;},
{onSuccess: callbackSuccess, onFailure: callbackFailure});</url>
</WebLink>

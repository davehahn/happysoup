<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>GMBLASERP__Fill</fullName>
    <availability>online</availability>
    <displayType>button</displayType>
    <linkType>javascript</linkType>
    <masterLabel>Fill</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <url>{!REQUIRESCRIPT(&quot;/soap/ajax/30.0/connection.js&quot;)}
{!REQUIRESCRIPT(&quot;/soap/ajax/30.0/apex.js&quot;)}

//launch a spinner
var spinDiv = document.createElement(&#39;div&#39;);
var spinCSS = &#39;&#39;;
spinCSS += &#39;background:rgba(0,0,0,.2);&#39;;
spinCSS += &#39;background-image:url(&quot;/img/loading32.gif&quot;);&#39;;
spinCSS += &#39;background-repeat:no-repeat;&#39;;
spinCSS += &#39;background-attachment:fixed;&#39;;
spinCSS += &#39;background-position:center;&#39;;
spinCSS += &#39;position:absolute;&#39;;
spinCSS += &#39;width:100%;&#39;;
spinCSS += &#39;height:100%;&#39;;
spinCSS += &#39;top:0;&#39;;
spinCSS += &#39;left:0;&#39;;
spinCSS += &#39;z-index:9998;&#39;;

spinDiv.id = &quot;spinDiv&quot;;
spinDiv.style.cssText = spinCSS;
document.body.appendChild(spinDiv);

var callbackSuccess = function(result) {
result = JSON.parse(result);
if(result.msg)
 alert(result.msg);
window.open(&#39;/{!AcctSeedERP__Sales_Order__c.Id}&#39;, &quot;_self&quot;);
};

var callbackFailure = function(error) {
alert(&#39;Process failure: &#39;+error);
window.open(&#39;/{!AcctSeedERP__Sales_Order__c.Id}&#39;, &quot;_self&quot;);
};

sforce.apex.execute(&quot;GMBLASERP.gcSalesOrder_Ext&quot;,&quot;fillOrderWS&quot;,{idSalesOrder:&quot;{!AcctSeedERP__Sales_Order__c.Id}&quot;},
{onSuccess: callbackSuccess, onFailure: callbackFailure});</url>
</WebLink>

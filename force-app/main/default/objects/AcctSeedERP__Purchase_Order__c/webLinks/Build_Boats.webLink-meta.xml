<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Build_Boats</fullName>
    <availability>online</availability>
    <displayType>button</displayType>
    <linkType>javascript</linkType>
    <masterLabel>Build Boats</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <url>{!REQUIRESCRIPT(&quot;/soap/ajax/30.0/connection.js&quot;)}
{!REQUIRESCRIPT(&quot;/soap/ajax/30.0/apex.js&quot;)}

function main(){

//launch a spinner
var spinDiv = document.createElement(&#39;div&#39;);
var spinCSS = &#39;&#39;;
spinCSS += &#39;background:rgba(0,0,0,.2);&#39;;
spinCSS += &#39;background-image:url(&quot;/img/loading32.gif&quot;);&#39;;
spinCSS += &#39;background-repeat:no-repeat;&#39;;
spinCSS += &#39;background-attachment:fixed;&#39;;
spinCSS += &#39;background-position:center;&#39;;
spinCSS += &#39;position:absolute;&#39;;
spinCSS += &#39;width:100%;&#39;;
spinCSS += &#39;height:100%;&#39;;
spinCSS += &#39;top:0;&#39;;
spinCSS += &#39;left:0;&#39;;
spinCSS += &#39;z-index:9998;&#39;;

spinDiv.id = &quot;spinDiv&quot;;
spinDiv.style.cssText = spinCSS;
document.body.appendChild(spinDiv);

var callbackSuccess = function(result) {
if(result==&#39;true&#39;)
{
window.open(&#39;/apex/pages/gpLegendMRP_buildBoats?idPurchaseOrder={!AcctSeedERP__Purchase_Order__c.Id}&amp;purchaseOrderNumber={!AcctSeedERP__Purchase_Order__c.Name}&#39;,&quot;_self&quot;);
}
else
{
alert(&#39;There are no available boats from this Purchase Order.&#39;);
document.body.removeChild(spinDiv);
}
};

var callbackFailure = function(error) {
document.body.removeChild(spinDiv);
alert(&#39;Error: &#39;+error);
};

//create a billing, and return its Id
var myNothing = sforce.apex.execute(&quot;gcLegendMRP&quot;,&quot;checkBoatsAvailableFromPO&quot;,{idPurchaseOrder:&quot;{!AcctSeedERP__Purchase_Order__c.Id}&quot;},
{onSuccess: callbackSuccess, onFailure: callbackFailure});

}
main();</url>
</WebLink>

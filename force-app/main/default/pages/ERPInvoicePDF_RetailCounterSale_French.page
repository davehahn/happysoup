<apex:page showHeader="false" sidebar="false" controller="ERPInvoicePDF" renderAs="pdf">

  <apex:stylesheet value="{!URLFOR($Resource.LegendPDF,'css/invoicePDF.min.css')}" />
  <apex:stylesheet value="{!URLFOR($Resource.LegendPDF,'css/dealer_invoice_page.css')}" />

  <div >
    <!-- +++++++++++++++++++++++++++++++++++++++ HEADER 1 ++++++++++++++++++++++++ -->
    <div class="row header1">

      <div class="left" >
        <img src="{!URLFOR($Resource.LegendPDF,'image/LegendLogoFR-250x30.png')}" />
      </div>

      <div class="right">

        <div>
          <img src="{!URLFOR($Resource.LegendPDF,'Icons/Email.png')}" />
          <p>info@legendboats.com</p>
        </div>

        <div>
          <img src="{!URLFOR($Resource.LegendPDF,'Icons/Phone.png')}" />
           <p>
            Tél
            <span style="float:right;padding-right:25px;">
              {!warehouse.Phone__c}
            </span>
          </p>
           <p>
            Sans Frais
            <span style="float:right;padding-right:25px;">
              {!warehouse.Toll_Free__c}
            </span>
          </p>
          <p>
            fax
            <span style="float:right;padding-right:25px;">
              {!warehouse.Fax__c}
            </span>
          </p>
        </div>

        <div style="position:relative">
          <img src="{!URLFOR($Resource.LegendPDF,'image/web.png')}" />
          <p>www.legendboats.com</p>
         <!--  <img src="https://www.barcodesinc.com/generator/image.php?code=INV-10812&amp;style=68&amp;type=C128B&amp;width=150&amp;height=40&amp;xres=1&amp;font=3" alt="Barcode" border="0"/> -->
          <p class="invoice_number">{!invoiceName}</p>
        </div>

      </div><!--header right close -->
    </div>
    <!-- ==================================== /HEADER 1 ============================  -->

    <!-- +++++++++++++++++++++++++++++++++++ HEADER 2 ++++++++++++++++++++++++++++++ -->
    <div class="row header2">

      <div>
        <p >
          <img src="{!URLFOR($Resource.LegendPDF,'Icons/Invoice.png')}" />
          <apex:outputPanel layout="none" rendered="{!erpOrder.Stage__c != 'Quoting'}">
            FACTURE Á:
          </apex:outputPanel>
          <apex:outputPanel layout="none" rendered="{!erpOrder.Stage__c == 'Quoting'}">
            SOUMISSION À:
          </apex:outputPanel>
        </p>
      </div>

      <div>
        <div>
          <div class="blockSummary">
            <table>
              <tr>
                <td>
                  <img src="{!URLFOR($Resource.LegendPDF,'image/dollar_trans.png')}" width="25" height="25" />
                </td>
                <td>
                  <img src="{!URLFOR($Resource.LegendPDF,'image/calendar_trans.png')}" width="25" height="25" />
                </td>
                <td>
                  <img src="{!URLFOR($Resource.LegendPDF,'image/invoice2_trans.png')}" width="25" height="25" />
                </td>
              </tr>

            </table>

            <div style="">
              <table>
                <tr>
                    <td style="">
                        <p>Total Sale:</p>
                        <apex:outputText value="${0, number, ###,###,###,##0.00}">
                              <apex:param value="{!erpOrder.Grand_Total__c - IF(ISNULL(erpOrder.Deposit__c), 0, erpOrder.Deposit__c)}"/>
                        </apex:outputText>
                    </td>
                    <td style="">
                        <p>Date de Facture:</p>
                        <p>{!invoiceDate}</p>
                    </td>
                    <td style="">
                        <p>Invoice #:</p>
                        <p>{!invoiceName}</p>
                    </td>
                </tr>
              </table>
            </div>

          </div>

        </div>

      </div>

    </div>
    <!-- ================================= /HEADER 2 =================================== -->


    <!-- +++++++++++++++++++++++++++++++++ CUSTOMER INFO +++++++++++++++++++++++++++++++++ -->
    <div class="row customer_info">

      <!-- +++++++++++++++++ BUYER INFO +++++++++++++++++++++ -->
      <div class="col col40">
        <p class="buyer_name">
         {!projectAccount.name}
        </p>
        <p class="buyer_address">
          {!address}
        </p>
      </div>
      <div class="col col40">
        <div class="buyer_details">
          <table style="width: 90%; margin:auto">
            <tr>
              <td class="icon" style="width: 20%">
                <img src="{!URLFOR($Resource.LegendPDF,'Icons/Email.png')}" />
              </td>
              <td>
                {!projectAccount.AccountEmail__c}
              </td>
              <td class="icon">
                <!-- <img src="{!URLFOR($Resource.LegendPDF,'Icons/Birthday.png')}" /> -->
              </td>
              <td>
                <!-- {!birthday} -->
              </td>
            </tr>
            <tr>
              <td class="icon" style="width: 20%">
                <img src="{!URLFOR($Resource.LegendPDF,'Icons/Cell.png')}" />
              </td>
              <td>
               {!projectAccount.phone}
              </td>
              <td class="icon">
                <!-- <img src="{!URLFOR($Resource.LegendPDF,'Icons/DriverLicense.png')}" /> -->
              </td>
              <td>
                <!-- {!projectAccount.Drivers_License__c} -->
              </td>
            </tr>
          </table>
        </div>
      </div>
      <!-- ================== /BUYER INFO ================== -->

      <!-- ++++++++++++++++ MEMORY MAKER ++++++++++++++++++++ -->
      <div class="col memory_maker" style="border-left:1px solid #CCC; width:19.8%;">
        <p>
          Votre Créateur de souvenirs
        </p>
        <p>
          {!erpOrder.Salesperson__r.name}
        </p>
      </div>
      <!-- ================ /MEMORY MAKER =================== -->

    </div>
    <!-- ================================== /CUSTOMER INFO =============================== -->

    <!-- +++++++++++++++++++++++++++++++++++ ITEMS ++++++++++++++++++++++++++++++ -->

    <table class="itemsTable hasKits" style="margin-bottom:25px;margin-top: 20px;">
        <thead>
          <tr>
            <td>Item Description</td>
            <td style="text-align:center">Quantity</td>
            <td style="text-align: right; padding-right: 5px;">Price</td>
            <td style="text-align: right; padding-right: 5px;">Total</td>
          </tr>
        </thead>
        <tbody>
          <apex:repeat value="{!materialList}" var="part" >
            <tr>
              <td class="w70" style="vertical-align: top;padding: 5px 0;">
                <table style="width: 100%; margin:0; padding: 0; border-collapse: collapse; height: 25px;">
                  <tr>
                    <td style="width: 35%; text-align:left; padding-left:0;">{!part.productCode}</td>
                    <td>
                      {!part.descriptionFR}
                      <span style="display:{!IF(ISBLANK(part.serialNumber), 'none','')}">
                        ( {!part.serialNumber} )
                      </span>
                    </td>
                  </tr>
                </table>
                <!-- <span style="display:inline-block: width: 50%">{!part.productCode}</span>
                <span style="display:inline-block">{!part.description}</span> -->
                <apex:outputPanel layout="block" styleClass="kit-contents" rendered="{!part.hasKitParts}" style=":padding-bottom: 5px;">
                  <table class="kitParts">
                    <apex:repeat value="{!part.kitParts}" var="kitPart">
                      <tr>
                        <td>{!kitPart.productCode}</td>
                        <td><apex:outputText value="{!kitPart.descriptionFR}" escape="false"></apex:outputText></td>
                        <td style="text-align:right;padding-right: 7px">{!kitPart.Quantity}</td>
                      </tr>
                    </apex:repeat>
                  </table>
                </apex:outputPanel>
              </td>
              <td class="w10" style="text-align: center; vertical-align: top;padding: 5px 0;">{!part.quantity}</td>
              <td class="w10 right" style="vertical-align: top;padding: 5px 0;">
                <apex:outputText value="${0, number, ###,###,###,##0.00}">
                  <apex:param value="{!part.unitPrice}"/>
                </apex:outputText>
              </td>
              <td class="w10 right" style="vertical-align: top;padding: 5px 0;">
                <apex:outputText value="${0, number, ###,###,###,##0.00}">
                  <apex:param value="{!part.price}"/>
                </apex:outputText>
              </td>
            </tr>
            <!-- <apex:outputPanel layout="none" rendered="{!part.hasKitParts}">
              <apex:repeat value="{!part.kitParts}" var="kitPart">
                <tr>
                  <td class="w75" style="padding-left: 10%">
                    <div style="display:inline-block; padding: 0 5px 0 10px;">
                      -
                    </div>
                    <apex:outputText value="{!kitPart.description}"/>
                  </td>
                  <td class="w5">{!kitPart.quantity}</td>
                  <td class="w15 right">
                    <apex:outputText value="{!IF(kitPart.price != 0,' ${0, number, ###,###,###,##0.00}','Included')} ">
                      <apex:param value="{!kitPart.price}"/>
                    </apex:outputText>
                  </td>
                </tr>
              </apex:repeat>
            </apex:outputPanel> -->
          </apex:repeat>
        </tbody>
      </table>

    <!-- ================================= /ITEMS ===================================== -->

    <!-- +++++++++++++++++++++++++++++ NOTES AND TOTALS +++++++++++++++++++++++++++++ -->
    <div class="row signatures_and_summary">
      <div class="col col65">
        <h2>Notes:</h2>
        <div class="notes_container">
          <apex:outputPanel rendered="{!!ISBLANK(partnerReference)}" layout="none">
            <p style="padding:0.25rem">
              <apex:outputText value="{! 'Partner Reference # '&partnerReference}" />
            </p>
          </apex:outputPanel>
          <p>
            <apex:outputText escape="false" value="{!customerNotes}" />
          </p>
        </div>
      </div>
      <div class="col col35 right">
        <table class="costSummary">
          <!-- <tr>
            <td>SUB TOTAL:</td>
            <td>
              <apex:outputText value="${0, number, ###,###,###,##0.00}">
                    <apex:param value="{!subTotal}"/>
               </apex:outputText>
            </td>
          </tr>
          <apex:outputPanel layout="none">
          <tr>
            <td class="decrease">SAVINGS:</td>
            <td class="decrease">
              - &nbsp;<apex:outputText value="${0, number, ###,###,###,##0.00}"
                                   rendered="{!totalSaving != null}">
                    <apex:param value="{!totalSaving}"/>
                  </apex:outputText>
            </td>
          </tr>
          </apex:outputPanel> -->
          <tr class="header-line">
            <td colspan="2" style="padding-top:0;">Sous Total;</td>
          </tr>

          <tr>
            <td style="padding-top:5px;">Total Avant Taxes:</td>
            <td style="padding-top:5px;">
              <apex:outputText value="${0, number, ###,###,###,##0.00}">
                <apex:param value="{!erpOrder.Order_Item_Total__c}"/>
              </apex:outputText>
            </td>
          </tr>
         <!-- OverRide Custom Taxes -->
          <apex:outputPanel layout="none" rendered="{!erpOrder.Tax_is_Harmonized__c == true}">
            <tr>
              <td> Tax (HST) {! erpOrder.Tax_Rate_Provincial__c + erpOrder.Tax_Rate_Federal__c}%: </td>
              <td>
                  <apex:outputText value="${0, number, ###,###,###,##0.00}">
                        <apex:param value="{!erpOrder.Tax_Amount_Provincial__c + erpOrder.Tax_Amount_Federal__c}"/>
                  </apex:outputText>
               </td>
            </tr>
          </apex:outputPanel>

          <apex:outputPanel layout="none" rendered="{!erpOrder.Tax_is_Harmonized__c != true}">
            <tr>
              <td> Tax ({!provTAxInfo.taxName}): {!erpOrder.Tax_Rate_Provincial__c}% </td>
              <td>
                  <apex:outputText value="${0, number, ###,###,###,##0.00}">
                        <apex:param value="{!erpOrder.Tax_Amount_Provincial__c}"/>
                  </apex:outputText>
               </td>
            </tr>
          </apex:outputPanel>

          <apex:outputPanel layout="none" rendered="{!erpOrder.Tax_is_Harmonized__c != true}">
            <tr>
              <td> Tax (TPS): {!erpOrder.Tax_Rate_Federal__c}% </td>
              <td>
                  <apex:outputText value="${0, number, ###,###,###,##0.00}">
                        <apex:param value="{!erpOrder.Tax_Amount_Federal__c}"/>
                  </apex:outputText>
               </td>
            </tr>
          </apex:outputPanel>
          <!-- Seperate taxes -->
          <apex:outputPanel layout="none" rendered="{!IF(erpOrder.Tax_Amount_Retail__c > 0,true, false)}">
            <tr>
              <td> TAX (RST): {!erpOrder.Tax_Rate_Retail__c}%: </td>
              <td>
                  <apex:outputText value="${0, number, ###,###,###,##0.00}">
                        <apex:param value="{!erpOrder.Tax_Amount_Retail__c}"/>
                  </apex:outputText>
               </td>
            </tr>
          </apex:outputPanel>

          <tr class="header-line">
            <td colspan="2">Payments</td>
          </tr>

          <tr>
            <td colspan="2">
              <table>
                <apex:repeat value="{!payments}" var="payment">
                  <tr>
                    <td style="text-align:left;">
                      <apex:outputText value="{0, date, MMM dd'/'yy}">
                        <apex:param value="{!payment.AcctSeed__Receipt_Date__c}" />
                      </apex:outputText>
                    </td>
                    <td style="text-align:left;">
                      {!payment.Payment_Method__c}
                    </td>
                    <td style="text-align:right !important;">
                      <apex:outputText value="${0, number, ###,###,###,##0.00}">
                        <apex:param value="{!payment.AcctSeed__Amount__c}"/>
                      </apex:outputText>
                    </td>
                  </tr>
                </apex:repeat>
              </table>
            </td>
          </tr>

          <apex:outputText rendered="{!IF(apReturns.size > 0,true,false)}">
          <tr class="header-line">
            <td colspan="2">Returns</td>
          </tr>

          <tr>
            <td colspan="2">
              <table>
                <apex:repeat value="{!apReturns}" var="returns">
                  <tr>
                    <td style="text-align:left;">
                      <apex:outputText value="{0, date, MMM dd'/'yy}">
                        <apex:param value="{!returns.AcctSeed__Disbursement_Date__c}" />
                      </apex:outputText>
                    </td>
                    <td style="text-align:left;">
                      {!returns.AcctSeed__Type__c}
                    </td>
                    <td style="text-align:right !important;">
                      <apex:outputText value="${0, number, ###,###,###,##0.00}">
                        <apex:param value="{!returns.AcctSeed__Amount__c}"/>
                      </apex:outputText>
                    </td>
                  </tr>
                </apex:repeat>
              </table>
            </td>
          </tr>
          </apex:outputText>
          <tr class="total">
            <td>Total Due:</td>
            <td style="padding-right: 3px;">
              <apex:outputText value="${0, number, ###,###,###,##0.00}">
                <apex:param value="{!erpOrder.Grand_Total__c - paymentTotal - returnTotal}"/>
              </apex:outputText>
            </td>
          </tr>


        </table>
      </div>
    </div>
    <!-- ============================= /NOTES AND TOTALS ======================== -- >

    <!-- ++++++++++++++++++++++++++++ FOOTER +++++++++++++++++++++++++++++++++++ -->
    <div class="row pdf_footer" style="position: fixed; bottom: 0;">

      <div class="thankyou">
        Merci d'avoir choisi Legend pour vous aider à créer des souvenirs sur l'eau.
      </div>

      <div class="col col30 logo">
        <img src="{!URLFOR($Resource.LegendPDF,'image/LegendLogoFR-220x26.png')}" />
      </div>

      <div class="col col33 address">
        <p>
          {!storeAddress}
        </p>
      </div>

      <div class="col col33 tax_numbers">
        <p>
          <apex:repeat value="{!taxNumbers}" var="tn">
            <span><b>{!tn.DeveloperName}#</b> {!tn.Tax_Number__c}</span>
          </apex:repeat>
        </p>
      </div>

    </div>
    <!-- ============================ FOOTER ================================== -->

  </div>

</apex:page>